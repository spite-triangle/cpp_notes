# 视频

# 基本知识

所谓视频帧就是由一系列差异很小的的图像构成的序列动画。常见的视频相关概念有
- **分辨率（Resolution）**：视频帧图像宽高
- **帧率（Frame rate per second）**: 一秒展示多少帧视频图像
- **帧类型**：根据视频帧的压缩方式进行分类，总计有三种类型
    - **I 帧（Intra coded frames）**：关键帧，使用帧内压缩，不使用运动补偿，不依赖其它帧，可以独立解码。
    - **P 帧（Predicted frames）**： 采用帧间编码方式，即同时利用了空间和时间上的相关性。P 帧图像采用前向时间预测。P 帧图像中可以包含帧内编码的部分，即 P 帧中的每一个宏块可以是前向预测，也可以是帧内编码。P 帧解码赖于前面的I帧或者P帧
    - **B 帧（Bi-directional predicted frames）**：采用帧间编码方式，且采用双向时间预测，依赖前后两帧。由于 B 帧图像采用了后面的帧作为参考，因此视频帧的传输顺序和显示顺序不同。B 帧解码既要依赖于前面的P帧或I帧，还依赖于其之后的P帧。

- **图像组（GOP）**：指两个关键帧（I帧）之间的距离。在码率不变的前提下，GOP值越大，P、B帧的数量会越多，平均每个I、P、B帧所占用的字节数就越多，也就更容易获取较好的图像质量

# 视频封装

**视频封装：** 存放已经编码压缩好的视频和音频的容器。常用的封装格式有 AVI、DV-AVI、QuickTime File Format、MPEG、Real Video、Matroska等。

- **AVI**

AVI是微软1992年推出用于对抗苹果 Quicktime 的技术，国际学术界公认AVI已经属于被淘汰的技术。AVI本身只是提供了这么一个框架，内部的图像数据和声音顺据格式可以是任意的编码形式。AVI的文件结构分为头部, 主体和索引三部分：主体中图像数据和声音数据是交互存放的；从尾部的索引可以索引跳到自己想放的位置。由于索引放在尾部，无法用于在线播放。

- **MOV**

MOV是 Quicktime 封装，这一封装和 AVI 几乎是同一时代的，缺陷也不少。

- **TS、PS**

因为HDDVD以及BD之争，尽管两家在编码上都统一采用 MPEG2/VC-1/H.264，可在封装格式上又有所分岐。
- HDDVD使用的是PS封装，即`Program Stream`(程序流)，这和之前DVD所采用的MPEG2 Program Stream封装是一样的，PS流的后缀名是`VOB`、`EVO`
- 使用了MPEG2的另一封装TS封装，即`Transport Stream`(传输流)，TS流的后缀名为`TS`

TS流对于PS流来说更易传输，但易出错。所以PS流主控用于存储，TS则适用于网络传输。`MPEG2-TS` 格式的特点就是要求从视频流的任一片段开始都是可以独立解码的。从结构上来说，TS是由头文件和主体所组成的，扩充过的TS流还包括时间戳，且通过时间戳就很容易同步图像与音频。

- **MKV**

MKV是Matroska的简称，它是一种新的多媒体封装格式，比较常见的搭配是X264+MKV。MKV封装十分新颖，而且也非常开放，它对比AVI的优势体现在以下几点：
1. 可变帧率
2. 错误检测与修复
3. 软字幕
4. 强大的兼容性
5. 流式传输
6. 开放性和跨平台性


# 视频编码

## 两大标准

**视频编码:** 一种压缩技术，把原始的视频流压缩成特定的比特流（视编码方案）。视频编码标准有两大系统
`MPEG 标准` 与`ITU-T 标准`。

- **MPEG**

英文全称为 `Moving Picture Experts Group`，即运动图像专家组格式 ，该专家组建于1988年，专门负责为CD建立视频和音频标准。MPEG文件格式是运动图像压缩算法的国际标准。MPEG格式目前有三个压缩标准，分别是 `MPEG－1`、`MPEG－2`和 `MPEG－4`。

- **ITU-T**

国际电信联盟远程通信标准化组（英语：ITU Telecommunication Standardization Sector，缩写ITU-T）是国际电信联盟管理下的专门制定远程通信相关国际标准的组织。其标准为H.26X系列： `H.261`、`H.262`、`H.263`、`H.263v2`、`H.264`

## 常用编码方式

- **DivX**

1998年微软开发了第一个在PC上使用的 `MPEG-4` 编码器，其中的`MS MPEG4 V3`系列的编解码能力都非常不错。但是该技术闭源，因此一帮黑客破解了 `MPEG4 V3` 并进行修改，开发出了 `DivX`。

- **XviD**

但后来 DXN 公司一顿骚操作把 `DivX 4` 闭源，为了嘲讽东家，原来视频团队出走，基于 `Open DivX` 重新开发了一套开源解码器，即 `XviD`。

- **H.264**

H.264，同时也是MPEG-4第十部分，是由ITU-T视频编码专家组（VCEG）和ISO/IEC动态图像专家组（MPEG）联合组成的联合视频组（JVT，Joint Video Team）提出的高度压缩数字视频编解码器标准。这个标准通常被称之为H.264/AVC（或者AVC/H.264或者H.264/MPEG-4 AVC或MPEG-4/H.264 AVC）而明确的说明它两方面的开发者。

- **MPEG2**

DVD编码格式。

- **MPEG4**

不仅针对一定比特率下的视频、音频编码，更加注重多媒体系统的交互性和灵活性。这个标准主要应用于视像电话、视像电子邮件等，对传输速率要求较低，在4800－64000bits／s之间，分辨率为176×144。MPEG－4利用很窄的带宽，通过帧重建技术、数据压缩，以求用最少的数据获得最佳的图像质量。

